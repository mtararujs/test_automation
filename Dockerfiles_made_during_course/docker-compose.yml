version: '3.8'
services:
  mysql_db:
    image: mysql:latest
    container_name: mysql_test_server
    environment: 
      - MYSQL_ROOT_PASSWORD=password
    volumes: 
      - $PWD/api_tests/scripts:/docker-entrypoint-initdb.d
    ports: 
      - 3306:3306
  api_mocks:
    image: ajnasz/api-mock
    container_name: api_mocks
    volumes: 
      - $PWD/api_tests/api.md:/usr/src/app/api.md
    ports:
      - 3000:3000
  ruby_ubuntu:
    build: api_tests
    container_name: ruby_test
    volumes: 
      - $PWD/api_tests/test-outputs:/usr/src/api-tests/test-output
    depends_on: 
      - mysql_db
      - api_mocks
  